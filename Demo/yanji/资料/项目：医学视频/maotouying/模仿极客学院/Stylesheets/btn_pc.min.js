/*! meiqia 2015-09-08 */
!function(){var a=MECHAT.Ani,b=MECHAT.Dom,c=MECHAT.Ajax,d=MECHAT.Lang,e=MECHAT.Color,f=MECHAT.Event,g=MECHAT.Cookie,h=MECHAT.Broswer,i="index.html";"lobegroup"===_CONFIG.custom&&(i="lobegroup.html");var j={chatHtml:"local"==_CONFIG.version?"./"+i:_CONFIG.chatHost+"/widget/desktop/"+i,visitHtml:"local"==_CONFIG.version?"./desktop_visit.html":_CONFIG.visitHost+"/widget/desktop/desktop_visit.html",button:_CONFIG.statHost+"/unit/button",imgPath:_CONFIG.sHost+"/images/",metadata:_CONFIG.chatHost+"/set/attrs",source:"PC",unitid:_CONFIG.unitid,cookieKey:"MECHAT_CKID",cookieVal:"",visitVal:"YES",cid:0,lp:window.location.href,title:document.title||"",referrer:document.referrer||"",dialPage:window.location.href||"",fromPage:h.mc_getReferrer()||"",colorId:"Initial",company:{uname:"",utel:"",uhead:"",ulogo:""},chatcnt:"",style:2,online_txt:"在线咨询",leave_txt:"给我们留言",lvmsg_txt:"",lvmsgChecks:{ismail:"true",ismsn:"true",isqq:"true",istel:"true"},isReady:!1,isRecMeta:!1,postMsgArr:[],btnClick:"MECHAT-BTNCLICK",timeMarkKey:"MECHAT-TIMEMARK",isChatOpen:!1,diffOnline:1e4,hasOnlineUServer:!0,priDomain:h.getPriDomain(),staff:_CONFIG.staff||"",group:_CONFIG.group||"",visitPushFlag:"open",setCookie:function(a,b){var c=this.priDomain,d=new Date;d.setTime(d.getTime()+108e5),c.indexOf(".")>0?g.set(a,b,d,"/",c):g.set(a,b,d)},getPath:function(){return window.location.protocol+"//"+window.location.host+window.location.pathname}},k={css:'#MECHAT-PCBTN{font-family: "Helvetica Neue", Helvetica, "Microsoft Yahei", Arial, sans-serif;font-size: 16px;line-height: 24px;position:fixed;bottom:-100%;background:#1abc9c;color:#fff;text-align:center;padding:10px 15px 8px;border-top-left-radius:5px;border-top-right-radius:5px;cursor:pointer;z-index:2147483645;}#MECHAT-PCBTN span{display:inline-block;height:24px;padding:0 0 0 34px;background:url("'+j.imgPath+'pc_btn_icon.png") 0 0 no-repeat}#MECHAT-LAYOUT{position:fixed;right:80px;bottom:-100%;width:300px;height:430px;z-index:2147483647; overflow:hidden;background: #fff;border:1px solid #1abc9c;border-top-left-radius:5px;border-top-right-radius:5px;box-shadow:0 0 3px 2px rgba(135,135,135,0.1)}#MECHAT-PCBTN,#MECHAT-LAYOUT{_position:absolute;_bottom:auto;_top:expression(eval(document.documentElement.scrollTop+document.documentElement.clientHeight-this.offsetHeight-(parseInt(this.currentStyle.marginTop,10)||0)-(parseInt(this.currentStyle.marginBottom,10)||0)))}',html:'<div id="MECHAT-LAYOUT"><iframe src="" style="width:100%;height:100%;border:0;" frameborder="no" scrolling="no"></iframe></div><div id="MECHAT-PCBTN"><span class="MECHAT-BTNLEAVE" style="color:#fff;">在线咨询</span></div><iframe src="" style="display:none;" id="MECHAT_VISIT"></iframe>'};"lobegroup"===_CONFIG.custom&&(k.css='#MECHAT-PCBTN{font-family: "Helvetica Neue",Helvetica, "Microsoft Yahei", Arial, sans-serif;font-size: 16px;line-height: 24px;position:fixed;bottom:-100%;background:#1abc9c;color:#fff;text-align:center;padding:10px 15px 8px;border-top-left-radius:5px;border-top-right-radius:5px;cursor:pointer;z-index:2147483645;}#MECHAT-PCBTN span{display:inline-block;height:24px;padding:0 0 0 34px;background:url("'+j.imgPath+'pc_btn_icon.png") 0 0 no-repeat;}#MECHAT-LAYOUT{position:fixed;top: 50%;left: 50%;z-index:2147483647;width:640px;height:460px;margin: -230px 0 0 -320px;overflow:hidden;background: #fff;border:1px solid #eee;border-radius:6px;box-shadow:0 0 3px 2px rgba(135,135,135,0.1);}#MECHAT-PCBTN{_position:absolute;_bottom:auto;_top:expression(eval(document.documentElement.scrollTop+document.documentElement.clientHeight-this.offsetHeight-(parseInt(this.currentStyle.marginTop,10)||0)-(parseInt(this.currentStyle.marginBottom,10)||0)));}');var l={button:function(a){var b={cookie:j.cookieVal,lp:j.lp,id:j.unitid,unitid:j.unitid,title:j.title,localr:j.referrer,source:j.source,fp:j.fromPage};j.setCookie("MECHAT_LVTime",(new Date).getTime()),c.jsonp(j.button,b,"mechat_btncb"),window.mechat_btncb=function(b){a(b)}},metadata:function(a){null!=a&&(a.unitid=j.unitid,a.cookie=j.cookieVal,a.source=j.source,c.jsonp(j.metadata,a,"metadataCallback"),window.metadataCallback=function(){})}},m={realName:"",sex:"",birthday:"",age:"",job:"",avatar:"",comment:"",appUserId:"",appUserName:"",appNickName:"",tel:"",email:"",address:"",QQ:"",weibo:"",weixin:"",appkey:"",from:"",extraParams:"",deviceBrand:"",deviceModel:"",os:"",osVersion:"",resolution:"",networkEnvironment:"",deviceToken:"",appVersion:"",osLanguage:"",osTimezone:"",filterProperty:function(a){var b=null;for(var c in a)this.hasOwnProperty(c)&&a[c]&&(b=null==b?{}:b,"extraParams"==c&&"object"==typeof a[c]?"undefined"!=typeof JSON&&(b.extraParams=JSON.stringify(a[c])):b[c]=a[c]);return b}},n=function(){var c=new Object;c.isPtMsg=!1,c.isVisit=!1;var h=!1;return c.init=function(){c.create(),c.btn=b.get("#MECHAT-PCBTN"),c.btnHeight=c.btn.offsetHeight,c.btnWidth=c.btn.offsetWidth,c.btnIcon=b.get("span",c.btn)[0],c.btnIcon.innerHTML=j.online_txt,c.layout=b.get("#MECHAT-LAYOUT"),c.layoutHeight=c.layout.offsetHeight,c.layoutWidth=c.layout.offsetWidth,b.hide(c.layout),c.chatFrame=b.get("iframe",c.layout)[0],c.visitFrame=b.get("#MECHAT_VISIT")},c.create=function(){b.loadStyle(k.css);var a=document.createElement("div");if(a.innerHTML=k.html,document.body.appendChild(a),"lobegroup"===_CONFIG.custom){var c=document.getElementById("MECHAT-LAYOUT"),d="#MECHAT-LAYOUT-HANDLE{position:absolute;top:0;right:80px;left:0;z-index:9999999;height:57px;cursor:move;display:none;}",e=document.createElement("div");e.id="MECHAT-LAYOUT-HANDLE",b.loadStyle(d),c.appendChild(e);var g=document.getElementById("MECHAT-LAYOUT-HANDLE");f.on(c,"mouseenter",function(){g.style.display="block"}),f.on(c,"mouseleave",function(){g.style.display="none"});var h;g.onmousedown=function(a){h=!0;var b=parseFloat(window.getComputedStyle?window.getComputedStyle(c,null).left:c.currentStyle.left),d=parseFloat(window.getComputedStyle?window.getComputedStyle(c,null).top:c.currentStyle.top),a=a||event,e=a.clientX-b,f=a.clientY-d;document.onmousemove=function(a){if(h){var a=a||event;c.style.left=a.clientX-e+"px",c.style.top=a.clientY-f+"px"}}},document.onmouseup=function(){h=!1}}},c.loadVisit=function(){if("NOT"!=j.visitVal&&MECHAT.Broswer.get()!=MECHAT.Broswer.IE6&&"close"!=j.visitPushFlag){c.isVisit=!0,h=!0;var a=j.visitHtml+"?unitid="+j.unitid+"&cookie="+j.cookieVal+"&cid="+j.cid+"&dev="+j.source+"&cn="+j.chatcnt;c.visitFrame.src=a}},c.loadChat=function(){if(MECHAT.Broswer.get()!=MECHAT.Broswer.IE6){var a=j.chatHtml+"?unitid="+j.unitid+"&cookie="+j.cookieVal+"&cid="+j.cid+"&color="+j.colorId;j.staff&&(a=a+"&staff="+j.staff),"undefined"!=typeof j.group&&""!=j.group&&(a=a+"&group="+j.group),"NOT"==j.visitVal&&(a+="&ol=auto"),_CONFIG.custom&&(a+="&custom="+_CONFIG.custom),c.chatFrame.src=a}},c.cookieSave=function(){j.setCookie(j.cookieKey,{cookieVal:j.cookieVal})},c.cookieRead=function(){var a=g.readObj(j.cookieKey);a.cookieVal&&(j.cookieVal=a.cookieVal)},c.msgToChat=function(a){a.lvmsg_txt=j.lvmsg_txt,a.ismail=j.lvmsgChecks.ismail,a.ismsn=j.lvmsgChecks.ismsn,a.isqq=j.lvmsgChecks.isqq,a.istel=j.lvmsgChecks.istel,a.cookie=j.cookieVal,a.dialPage=j.dialPage,a.hasOnlineUServer=j.hasOnlineUServer,a=d.objToStr(a),j.postMsgArr.push(a),c.postMsg(),j.visitVal="NOT"},c.msgTohands=function(){var a={mechat:"MECHAT-CHAT-HANNDS",dialPage:j.dialPage};a=d.objToStr(a),c.postMsg2Frame(a)},c.postMsg=function(){if(j.isReady&&j.postMsgArr.length>0){for(var a,b=0,d=j.postMsgArr.length;d>b;b++)a=j.postMsgArr[b],c.postMsg2Frame(a);j.postMsgArr=new Array}},c.postMsg2Frame=function(a){h&&c.visitFrame&&c.visitFrame.contentWindow&&c.visitFrame.contentWindow.postMessage&&c.visitFrame.contentWindow.postMessage(a,"*"),c.chatFrame&&c.chatFrame.contentWindow&&c.chatFrame.contentWindow.postMessage&&c.chatFrame.contentWindow.postMessage(a,"*")},c.buttonStyle=function(){c.setColor(),c.setLeft(),c.btnIcon.innerHTML=j.online_txt},c.setLeft=function(){1==j.style?(b.css(c.btn,"left","100px"),"lobegroup"!==_CONFIG.custom&&b.css(c.layout,"left","50px")):2==j.style?(b.css(c.btn,"right","100px"),"lobegroup"!==_CONFIG.custom&&b.css(c.layout,"right","80px")):b.hide(c.btn)},c.setColor=function(){var a=e.get(j.colorId);a&&("lobegroup"===_CONFIG.custom?(b.css(c.btn,"background","#bea257"),f.on(c.btn,"mouseover",function(){b.css(c.btn,"background","#b9932e")}),f.on(c.btn,"mouseout",function(){b.css(c.btn,"background","#bea257")})):(b.css(c.btn,"background",a[0]),b.css(c.layout,"border","1px solid "+a[0]),b.css(c.layout,"border-bottom","none"),f.on(c.btn,"mouseover",function(){b.css(c.btn,"background",a[1])}),f.on(c.btn,"mouseout",function(){b.css(c.btn,"background",a[0])})))},c.setLeaveBtn=function(){c.btnIcon.innerHTML=j.leave_txt,b.css(c.btnIcon,"background-position","0 -27px")},c.setOnlineBtn=function(){c.btnIcon.innerHTML=j.online_txt,b.css(c.btnIcon,"background-position","0 0")},c.btnShow=function(){3!=j.style&&a.move(c.btn,{bottom:0,b:-c.btnHeight})},c.btnHide=function(){3!=j.style&&a.move(c.btn,{bottom:-c.btnHeight,b:0})},c.isLBBROWSER=function(){var a=navigator.userAgent;return a.indexOf("LBBROWSER")>0||a.indexOf("Chrome/34")>0||a.indexOf("Chrome/35")>0||a.indexOf("MetaSr")>0},c.layoutShow=function(){j.isChatOpen=!0,c.btnHide(),j.setCookie("MECHAT-OLDFRIEND",!0),c.isLBBROWSER()?(b.css(c.layout,"bottom","0px"),b.show(c.layout)):(b.show(c.layout),a.move(c.layout,{bottom:0,b:-c.layoutHeight})),c.isPtMsg?c.msgToChat({mechat:"MECHAT-LAYOUT-SHOW"}):(c.msgToChat({mechat:"MECHAT-CHAT-SHOW",usname:j.company.uname,ustel:j.company.utel||"",usavatar:j.company.ulogo||""}),c.isVisit=!1,c.isPtMsg=!0,c.cookieSave())},c.layoutHide=function(){j.isChatOpen=!1,a.move(c.layout,{bottom:-c.layoutHeight,b:0},60,function(){b.hide(c.layout),c.btnShow()})},c},o=function(){function a(a,c){if(b[a])try{b[a].apply(b,c)}catch(d){}}var b=this;return{onOpen:function(){a("OnMechatOpen",arguments)},onClose:function(){a("OnMechatClose",arguments)}}}.call(window),p=function(){var a=new Object,b=new n;return a.isChatShow=!1,a.getView=function(){return b},a.sendMetadata=function(a){if(a&&"object"==typeof a){var b=m.filterProperty(a);l.metadata(b)}},a.init=function(){if("function"==typeof getMeChatPartnerUserID){var c=getMeChatPartnerUserID();if("object"==typeof c&&null!=c&&c.hasOwnProperty("userId")){var e=c.userId;e&&"undefined"!=e&&e.length>=2&&(j.cookieVal=d.html_encode(d.trim(e)))}}b.init(),j.cookieVal||b.cookieRead(),MECHAT.Broswer.get()==MECHAT.Broswer.IE6&&(j.visitVal="NOT"),g.read("MECHAT-OLDFRIEND")&&(j.visitVal="NOT"),a.button(),a.readClick(),f.on(b.btn,"click",function(){a.btnClick()}),window.mechatClick=function(){a.btnClick()}},a.buttonCb=function(c){c.success&&(j.cookieVal=c.cookie||"",b.cookieSave(),a.readBtnData(c),b.loadVisit(),b.loadChat(),b.buttonStyle(),b.btnShow(),j.hasOnlineUServer||a.userver(),a.resetHref(),window.mechatMetadata=function(b){a.sendMetadata(b)})},a.button=function(){"object"==typeof BtnData?a.buttonCb(BtnData):l.button(function(b){a.buttonCb(b)})},a.postMsg=function(){b.postMsg()},a.msgTohands=function(){b.msgTohands()},a.readBtnData=function(a){j.chatcnt=a.chatCnt||j.chatcnt,j.style=a.pc_ubutton.style||j.style,_CONFIG.btn&&"hide"==_CONFIG.btn&&(j.style=3),j.colorId=a.pc_ubutton.color||j.colorId,j.visitPushFlag=a.pc_ubutton.visitPushFlag||j.visitPushFlag,j.online_txt=a.pc_ubutton.online||j.online_txt,j.leave_txt=a.pc_ubutton.leave||j.leave_txt,j.company.uname=a.uname,j.company.utel=a.utel,j.company.ulogo=a.pc_ubutton.unitLogo,j.lvmsg_txt=a.lvmsgNote||"",j.lvmsgChecks=a.lvmsgChecks||j.lvmsgChecks,void 0!=typeof a.unitHasOnlineUServer&&("false"==a.unitHasOnlineUServer||0==a.unitHasOnlineUServer)&&(j.hasOnlineUServer=!1)},a.visitMsg=function(c,d,e,f,g,h){b.isPtMsg=!0,a.btnHide(),b.msgToChat({mechat:"MECHAT_VISIT_MSG",content:e,usname:c,ustel:f||"",picurl:g||"",fromId:h||""})},a.btnShow=function(){a.isChatShow&&(b.layoutHide(),a.isChatShow=!1,o.onClose())},a.btnHide=function(){a.isChatShow||(b.layoutShow(),a.isChatShow=!0,o.onOpen())},a.btnClick=function(){return MECHAT.Broswer.get()==MECHAT.Broswer.IE6?(window.location.href=_CONFIG.wwwHost+"/chat/"+j.unitid,void 0):(a.isChatShow?a.btnShow():a.btnHide(),void 0)},a.userver=function(){b.setLeaveBtn()},a.saveClick=function(){},a.readClick=function(){},a.setHref=function(a,b){if(a&&b){var c=b.split("?")[0],d=(c.split("chat/")[1]||"").split("/")[1],e=b.split("?")[1],f=h.parseQuerystring(e);d&&(f.staff=d);var g="&_realref_="+encodeURIComponent(j.getPath()),i="cookie="+j.cookieVal,k=j.chatHtml+"?unitid="+j.unitid+"&win=max&ol=auto&color="+j.colorId+"&";for(var l in f)"unitid"!=l&&"win"!=l&&"ol"!=l&&"color"!=l&&(k=k+l+"="+f[l]+"&");k=k+i+g,_CONFIG.custom&&(k+="&custom="+_CONFIG.custom),a.setAttribute("href",k)}},a.resetHref=function(){var b=["meiqia.com/chat/","mobilechat/chat/","mechat.im/chat/","mechatim.com/chat/","mobilechat.im/chat/"],c=function(c){for(var d=document.getElementsByTagName(c),e=0,f=d.length;f>e;e++){var g=d[e];if(g&&g.getAttribute){var h=g.getAttribute("href");if(h)for(var i=0,j=b.length;j>i;i++){var k=b[i];if(h.indexOf(k)>=0){a.setHref(g,h);break}}}}};c("a"),c("area")},a};!function(){if(!j.unitid||void 0==j.unitid||"undefined"==j.unitid||"null"==j.unitid)return!1;var a=new p;a.init(),MECHAT.Event.on(window,"message",function(b){var c=d.strToObj(b.data);if("string"==typeof c)switch(c){case"MECHAT-OPEN":a.btnHide();break;case"MECHAT-CLOSE":a.btnShow();break;case"MECHAT-USERVER":a.userver();break;case"MECHAT-READY":j.isReady=!0,a.msgTohands(),a.postMsg();break;case"MECHAT-METADATA":}else if("object"==typeof c&&c.mechat)switch(c.mechat){case"MECHAT-VISIT-INVITE":a.getView().isVisit&&a.visitMsg(c.fromName,c.usavatar,c.content,c.ustel,c.picUrl,c.fromId)}})}()}();